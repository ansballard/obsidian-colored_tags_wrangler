// ---------------------------------------------------------------------------------------------------------------------
// Code
// ---------------------------------------------------------------------------------------------------------------------
export function hexToRgb(hexColor) {
    const hex = hexColor.replace("#", "");
    return {
        r: parseInt(hex.slice(0, 2), 16),
        g: parseInt(hex.slice(2, 4), 16),
        b: parseInt(hex.slice(4, 6), 16)
    };
}
// ---------------------------------------------------------------------------------------------------------------------
export function rgbToHex(rgb) {
    const toHex = (c) => c.toString(16).padStart(2, "0");
    return `#${toHex(rgb.r)}${toHex(rgb.g)}${toHex(rgb.b)}`;
}
// ---------------------------------------------------------------------------------------------------------------------
export function rgbToHsl(rgb) {
    // Normalize RGB values to the range [0, 1]
    const r = rgb.r / 255;
    const g = rgb.g / 255;
    const b = rgb.b / 255;
    // Find the maximum and minimum values among R, G, and B
    const max = Math.max(r, g, b);
    const min = Math.min(r, g, b);
    // Calculate the lightness (L)
    const l = (max + min) / 2;
    let h = 0;
    let s = 0;
    if (max !== min) {
        // Calculate the saturation (S)
        s = l > 0.5 ? (max - min) / (2 - max - min) : (max - min) / (max + min);
        // Calculate the hue (H)
        if (max === r) {
            h = (60 * ((g - b) / (max - min)) + 360) % 360;
        }
        else if (max === g) {
            h = 60 * ((b - r) / (max - min)) + 120;
        }
        else {
            h = 60 * ((r - g) / (max - min)) + 240;
        }
    }
    return { h, s, l };
}
// ---------------------------------------------------------------------------------------------------------------------
export function hslToRgb(hsl) {
    const { h, s, l } = hsl;
    // Ensure the hue is within the range [0, 360]
    const normalizedHue = (h % 360 + 360) % 360;
    // Convert the saturation and lightness to the [0, 1] range
    const normalizedSaturation = Math.max(0, Math.min(1, s));
    const normalizedLightness = Math.max(0, Math.min(1, l));
    const chroma = (1 - Math.abs(2 * normalizedLightness - 1)) * normalizedSaturation;
    const x = chroma * (1 - Math.abs(((normalizedHue / 60) % 2) - 1));
    const m = normalizedLightness - chroma / 2;
    let r = 0, g = 0, b = 0;
    if (normalizedHue >= 0 && normalizedHue < 60) {
        r = chroma;
        g = x;
    }
    else if (normalizedHue >= 60 && normalizedHue < 120) {
        r = x;
        g = chroma;
    }
    else if (normalizedHue >= 120 && normalizedHue < 180) {
        g = chroma;
        b = x;
    }
    else if (normalizedHue >= 180 && normalizedHue < 240) {
        g = x;
        b = chroma;
    }
    else if (normalizedHue >= 240 && normalizedHue < 300) {
        r = x;
        b = chroma;
    }
    else {
        r = chroma;
        b = x;
    }
    r = Math.round((r + m) * 255);
    g = Math.round((g + m) * 255);
    b = Math.round((b + m) * 255);
    return { r, g, b };
}
// ---------------------------------------------------------------------------------------------------------------------
export function hexToRGBA(hex, alpha) {
    // Remove the hash (#) from the beginning of the HEX string
    hex = hex.replace(/^#/, '');
    // Ensure the alpha value is between 0 and 1
    if (alpha < 0)
        alpha = 0;
    if (alpha > 1)
        alpha = 1;
    // Parse the HEX values into separate red, green, and blue components
    const r = parseInt(hex.substring(0, 2), 16);
    const g = parseInt(hex.substring(2, 4), 16);
    const b = parseInt(hex.substring(4, 6), 16);
    // Convert the RGB values and alpha to the rgba format
    return { r, g, b, a: alpha };
}
// ---------------------------------------------------------------------------------------------------------------------
export function stringToHsl(txt) {
    const hslArray = txt
        .replace("hsl(", "")
        .replace(")", "")
        .split(",")
        .map(v => v.trim());
    return {
        h: Number(hslArray[0]),
        s: hslArray[1].endsWith("%")
            ? (Number(hslArray[1].replace("%", "")) / 100)
            : (Number(hslArray[1])),
        l: hslArray[2].endsWith("%")
            ? (Number(hslArray[2].replace("%", "")) / 100)
            : (Number(hslArray[2])),
    };
}
// ---------------------------------------------------------------------------------------------------------------------
export function stringToRgb(txt) {
    const textArray = txt
        .replace("rgb(", "")
        .replace(")", "")
        .split(",")
        .map(v => v.trim());
    return {
        r: Number(textArray[0]),
        g: Number(textArray[1]),
        b: Number(textArray[2]),
    };
}
export function stringToRgba(txt) {
    const textArray = txt
        .replace("rgba(", "")
        .replace(")", "")
        .split(",")
        .map(v => v.trim());
    return {
        r: Number(textArray[0]),
        g: Number(textArray[1]),
        b: Number(textArray[2]),
        a: Number(textArray[3])
    };
}
export function rgbToString(color) {
    return `rgb(${color.r}, ${color.g}, ${color.b})`;
}
export function rgbaToString(color) {
    return `rgba(${color.r}, ${color.g}, ${color.b}, ${color.a})`;
}
export function rgbaToHex(color) {
    const { r, g, b } = color;
    return '#' + [r, g, b].map(x => {
        const hex = x.toString(16);
        return hex.length === 1 ? '0' + hex : hex;
    }).join('');
}
export function getContrastColor(rgb) {
    // Calculate the brightness of the foreground color (simple approximation)
    let brightness = (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
    // If the foreground is bright, use black; otherwise use white
    return brightness > 128 ? { r: 0, g: 0, b: 0 } : { r: 255, g: 255, b: 255 };
}
export function getContrastBool(rgb) {
    return getContrastColor(rgb).r === 0;
}
function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
}
export function adjustBrightness(rgb, factor) {
    const r = rgb.r / 255, g = rgb.g / 255, b = rgb.b / 255;
    const max = Math.max(r, g, b), min = Math.min(r, g, b);
    let h = 0, s = 0, l = (max + min) / 2;
    if (max !== min) {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
            case r:
                h = (g - b) / d + (g < b ? 6 : 0);
                break;
            case g:
                h = (b - r) / d + 2;
                break;
            case b:
                h = (r - g) / d + 4;
                break;
        }
        h /= 6;
    }
    l = clamp(l * factor, 0, 1);
    let r1, g1, b1;
    if (s === 0) {
        r1 = g1 = b1 = l;
    }
    else {
        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;
        r1 = hue2rgb(p, q, h + 1 / 3);
        g1 = hue2rgb(p, q, h);
        b1 = hue2rgb(p, q, h - 1 / 3);
    }
    return { r: clamp(Math.round(r1 * 255), 0, 255), g: clamp(Math.round(g1 * 255), 0, 255), b: clamp(Math.round(b1 * 255), 0, 255) };
    function hue2rgb(p, q, t) {
        if (t < 0)
            t += 1;
        if (t > 1)
            t -= 1;
        if (t < 1 / 6)
            return clamp(p + (q - p) * 6 * t, 0, 1);
        if (t < 1 / 2)
            return clamp(q, 0, 1);
        if (t < 2 / 3)
            return clamp(p + (q - p) * (2 / 3 - t) * 6, 0, 1);
        return clamp(p, 0, 1);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29sb3JDb252ZXJ0ZXJzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQ29sb3JDb252ZXJ0ZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU1BLHdIQUF3SDtBQUN4SCxPQUFPO0FBQ1Asd0hBQXdIO0FBQ3hILE1BQU0sVUFBVSxRQUFRLENBQUMsUUFBZTtJQUN2QyxNQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN0QyxPQUFPO1FBQ04sQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDaEMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDaEMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7S0FDaEMsQ0FBQTtBQUNGLENBQUM7QUFDRCx3SEFBd0g7QUFDeEgsTUFBTSxVQUFVLFFBQVEsQ0FBQyxHQUFRO0lBQ2hDLE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBUyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDN0QsT0FBTyxJQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7QUFDekQsQ0FBQztBQUNELHdIQUF3SDtBQUN4SCxNQUFNLFVBQVUsUUFBUSxDQUFDLEdBQVE7SUFDaEMsMkNBQTJDO0lBQzNDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsQ0FB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QUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUM7SUFFbEksU0FBUyxPQUFPLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxDQUFTO1FBQy9DLElBQUcsQ0FBQyxHQUFHLENBQUM7WUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2pCLElBQUcsQ0FBQyxHQUFHLENBQUM7WUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2pCLElBQUcsQ0FBQyxHQUFHLENBQUMsR0FBQyxDQUFDO1lBQUUsT0FBTyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3BELElBQUcsQ0FBQyxHQUFHLENBQUMsR0FBQyxDQUFDO1lBQUUsT0FBTyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNsQyxJQUFHLENBQUMsR0FBRyxDQUFDLEdBQUMsQ0FBQztZQUFFLE9BQU8sS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM1RCxPQUFPLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7QUFDRixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEltcG9ydHNcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmltcG9ydCB7UkdCLCBIU0x9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQge1JHQkF9IGZyb20gXCIuLi9jb250cmFjdHMvdHlwZXMvUkdCQVwiO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENvZGVcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmV4cG9ydCBmdW5jdGlvbiBoZXhUb1JnYihoZXhDb2xvcjpzdHJpbmcpIDogUkdCe1xyXG5cdGNvbnN0IGhleCA9IGhleENvbG9yLnJlcGxhY2UoXCIjXCIsIFwiXCIpO1xyXG5cdHJldHVybiB7XHJcblx0XHRyOiBwYXJzZUludChoZXguc2xpY2UoMCwgMiksIDE2KSxcclxuXHRcdGc6IHBhcnNlSW50KGhleC5zbGljZSgyLCA0KSwgMTYpLFxyXG5cdFx0YjogcGFyc2VJbnQoaGV4LnNsaWNlKDQsIDYpLCAxNilcclxuXHR9XHJcbn1cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmV4cG9ydCBmdW5jdGlvbiByZ2JUb0hleChyZ2I6IFJHQik6IHN0cmluZyB7XHJcblx0Y29uc3QgdG9IZXggPSAoYzogbnVtYmVyKSA9PiBjLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCBcIjBcIik7XHJcblx0cmV0dXJuIGAjJHt0b0hleChyZ2Iucil9JHt0b0hleChyZ2IuZyl9JHt0b0hleChyZ2IuYil9YDtcclxufVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuZXhwb3J0IGZ1bmN0aW9uIHJnYlRvSHNsKHJnYjogUkdCKTogSFNMIHtcclxuXHQvLyBOb3JtYWxpemUgUkdCIHZhbHVlcyB0byB0aGUgcmFuZ2UgWzAsIDFdXHJcblx0Y29uc3QgciA9IHJnYi5yIC8gMjU1O1xyXG5cdGNvbnN0IGcgPSByZ2IuZyAvIDI1NTtcclxuXHRjb25zdCBiID0gcmdiLmIgLyAyNTU7XHJcblxyXG5cdC8vIEZpbmQgdGhlIG1heGltdW0gYW5kIG1pbmltdW0gdmFsdWVzIGFtb25nIFIsIEcsIGFuZCBCXHJcblx0Y29uc3QgbWF4ID0gTWF0aC5tYXgociwgZywgYik7XHJcblx0Y29uc3QgbWluID0gTWF0aC5taW4ociwgZywgYik7XHJcblxyXG5cdC8vIENhbGN1bGF0ZSB0aGUgbGlnaHRuZXNzIChMKVxyXG5cdGNvbnN0IGwgPSAobWF4ICsgbWluKSAvIDI7XHJcblxyXG5cdGxldCBoID0gMDtcclxuXHRsZXQgcyA9IDA7XHJcblxyXG5cdGlmIChtYXggIT09IG1pbikge1xyXG5cdFx0Ly8gQ2FsY3VsYXRlIHRoZSBzYXR1cmF0aW9uIChTKVxyXG5cdFx0cyA9IGwgPiAwLjUgPyAobWF4IC0gbWluKSAvICgyIC0gbWF4IC0gbWluKSA6IChtYXggLSBtaW4pIC8gKG1heCArIG1pbik7XHJcblxyXG5cdFx0Ly8gQ2FsY3VsYXRlIHRoZSBodWUgKEgpXHJcblx0XHRpZiAobWF4ID09PSByKSB7XHJcblx0XHRcdGggPSAoNjAgKiAoKGcgLSBiKSAvIChtYXggLSBtaW4pKSArIDM2MCkgJSAzNjA7XHJcblx0XHR9IGVsc2UgaWYgKG1heCA9PT0gZykge1xyXG5cdFx0XHRoID0gNjAgKiAoKGIgLSByKSAvIChtYXggLSBtaW4pKSArIDEyMDtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGggPSA2MCAqICgociAtIGcpIC8gKG1heCAtIG1pbikpICsgMjQwO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHsgaCwgcywgbCB9O1xyXG59XHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5leHBvcnQgZnVuY3Rpb24gaHNsVG9SZ2IoaHNsOiB7IGg6IG51bWJlcjsgczogbnVtYmVyOyBsOiBudW1iZXIgfSk6IFJHQiB7XHJcblx0Y29uc3QgeyBoLCBzLCBsIH0gPSBoc2w7XHJcblxyXG5cdC8vIEVuc3VyZSB0aGUgaHVlIGlzIHdpdGhpbiB0aGUgcmFuZ2UgWzAsIDM2MF1cclxuXHRjb25zdCBub3JtYWxpemVkSHVlID0gKGggJSAzNjAgKyAzNjApICUgMzYwO1xyXG5cclxuXHQvLyBDb252ZXJ0IHRoZSBzYXR1cmF0aW9uIGFuZCBsaWdodG5lc3MgdG8gdGhlIFswLCAxXSByYW5nZVxyXG5cdGNvbnN0IG5vcm1hbGl6ZWRTYXR1cmF0aW9uID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgcykpO1xyXG5cdGNvbnN0IG5vcm1hbGl6ZWRMaWdodG5lc3MgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBsKSk7XHJcblxyXG5cdGNvbnN0IGNocm9tYSA9ICgxIC0gTWF0aC5hYnMoMiAqIG5vcm1hbGl6ZWRMaWdodG5lc3MgLSAxKSkgKiBub3JtYWxpemVkU2F0dXJhdGlvbjtcclxuXHRjb25zdCB4ID0gY2hyb21hICogKDEgLSBNYXRoLmFicygoKG5vcm1hbGl6ZWRIdWUgLyA2MCkgJSAyKSAtIDEpKTtcclxuXHRjb25zdCBtID0gbm9ybWFsaXplZExpZ2h0bmVzcyAtIGNocm9tYSAvIDI7XHJcblxyXG5cdGxldCByID0gMCwgZyA9IDAsIGIgPSAwO1xyXG5cclxuXHRpZiAobm9ybWFsaXplZEh1ZSA+PSAwICYmIG5vcm1hbGl6ZWRIdWUgPCA2MCkge1xyXG5cdFx0ciA9IGNocm9tYTtcclxuXHRcdGcgPSB4O1xyXG5cdH0gZWxzZSBpZiAobm9ybWFsaXplZEh1ZSA+PSA2MCAmJiBub3JtYWxpemVkSHVlIDwgMTIwKSB7XHJcblx0XHRyID0geDtcclxuXHRcdGcgPSBjaHJvbWE7XHJcblx0fSBlbHNlIGlmIChub3JtYWxpemVkSHVlID49IDEyMCAmJiBub3JtYWxpemVkSHVlIDwgMTgwKSB7XHJcblx0XHRnID0gY2hyb21hO1xyXG5cdFx0YiA9IHg7XHJcblx0fSBlbHNlIGlmIChub3JtYWxpemVkSHVlID49IDE4MCAmJiBub3JtYWxpemVkSHVlIDwgMjQwKSB7XHJcblx0XHRnID0geDtcclxuXHRcdGIgPSBjaHJvbWE7XHJcblx0fSBlbHNlIGlmIChub3JtYWxpemVkSHVlID49IDI0MCAmJiBub3JtYWxpemVkSHVlIDwgMzAwKSB7XHJcblx0XHRyID0geDtcclxuXHRcdGIgPSBjaHJvbWE7XHJcblx0fSBlbHNlIHtcclxuXHRcdHIgPSBjaHJvbWE7XHJcblx0XHRiID0geDtcclxuXHR9XHJcblxyXG5cdHIgPSBNYXRoLnJvdW5kKChyICsgbSkgKiAyNTUpO1xyXG5cdGcgPSBNYXRoLnJvdW5kKChnICsgbSkgKiAyNTUpO1xyXG5cdGIgPSBNYXRoLnJvdW5kKChiICsgbSkgKiAyNTUpO1xyXG5cclxuXHRyZXR1cm4geyByLCBnLCBiIH07XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5leHBvcnQgZnVuY3Rpb24gaGV4VG9SR0JBKGhleDpzdHJpbmcsIGFscGhhOm51bWJlcik6UkdCQSB7XHJcblx0Ly8gUmVtb3ZlIHRoZSBoYXNoICgjKSBmcm9tIHRoZSBiZWdpbm5pbmcgb2YgdGhlIEhFWCBzdHJpbmdcclxuXHRoZXggPSBoZXgucmVwbGFjZSgvXiMvLCAnJyk7XHJcblxyXG5cdC8vIEVuc3VyZSB0aGUgYWxwaGEgdmFsdWUgaXMgYmV0d2VlbiAwIGFuZCAxXHJcblx0aWYgKGFscGhhIDwgMCkgYWxwaGEgPSAwO1xyXG5cdGlmIChhbHBoYSA+IDEpIGFscGhhID0gMTtcclxuXHJcblx0Ly8gUGFyc2UgdGhlIEhFWCB2YWx1ZXMgaW50byBzZXBhcmF0ZSByZWQsIGdyZWVuLCBhbmQgYmx1ZSBjb21wb25lbnRzXHJcblx0Y29uc3QgciA9IHBhcnNlSW50KGhleC5zdWJzdHJpbmcoMCwgMiksIDE2KTtcclxuXHRjb25zdCBnID0gcGFyc2VJbnQoaGV4LnN1YnN0cmluZygyLCA0KSwgMTYpO1xyXG5cdGNvbnN0IGIgPSBwYXJzZUludChoZXguc3Vic3RyaW5nKDQsIDYpLCAxNik7XHJcblxyXG5cdC8vIENvbnZlcnQgdGhlIFJHQiB2YWx1ZXMgYW5kIGFscGhhIHRvIHRoZSByZ2JhIGZvcm1hdFxyXG5cdHJldHVybiB7cixnLGIsIGE6YWxwaGF9XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nVG9Ic2wodHh0OnN0cmluZyk6SFNMe1xyXG5cdGNvbnN0IGhzbEFycmF5ID0gdHh0XHJcblx0XHQucmVwbGFjZShcImhzbChcIiwgXCJcIilcclxuXHRcdC5yZXBsYWNlKFwiKVwiLCBcIlwiKVxyXG5cdFx0LnNwbGl0KFwiLFwiKVxyXG5cdFx0Lm1hcCh2PT4gdi50cmltKCkpXHJcblx0cmV0dXJuIHtcclxuXHRcdGg6TnVtYmVyKGhzbEFycmF5WzBdKSxcclxuXHRcdHM6aHNsQXJyYXlbMV0uZW5kc1dpdGgoXCIlXCIpXHJcblx0XHRcdD8gKE51bWJlcihoc2xBcnJheVsxXS5yZXBsYWNlKFwiJVwiLCBcIlwiKSkgLyAxMDApXHJcblx0XHRcdDogKE51bWJlcihoc2xBcnJheVsxXSkpLFxyXG5cdFx0bDpoc2xBcnJheVsyXS5lbmRzV2l0aChcIiVcIilcclxuXHRcdFx0PyAoTnVtYmVyKGhzbEFycmF5WzJdLnJlcGxhY2UoXCIlXCIsIFwiXCIpKSAvIDEwMClcclxuXHRcdFx0OiAoTnVtYmVyKGhzbEFycmF5WzJdKSksXHJcblx0fVxyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ1RvUmdiKHR4dDpzdHJpbmcpOlJHQntcclxuXHRjb25zdCB0ZXh0QXJyYXkgPSB0eHRcclxuXHRcdC5yZXBsYWNlKFwicmdiKFwiLCBcIlwiKVxyXG5cdFx0LnJlcGxhY2UoXCIpXCIsIFwiXCIpXHJcblx0XHQuc3BsaXQoXCIsXCIpXHJcblx0XHQubWFwKHY9PiB2LnRyaW0oKSlcclxuXHRyZXR1cm4ge1xyXG5cdFx0cjpOdW1iZXIodGV4dEFycmF5WzBdKSxcclxuXHRcdGc6TnVtYmVyKHRleHRBcnJheVsxXSksXHJcblx0XHRiOk51bWJlcih0ZXh0QXJyYXlbMl0pLFxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ1RvUmdiYSh0eHQ6U3RyaW5nKTpSR0JBe1xyXG5cdGNvbnN0IHRleHRBcnJheSA9IHR4dFxyXG5cdFx0LnJlcGxhY2UoXCJyZ2JhKFwiLCBcIlwiKVxyXG5cdFx0LnJlcGxhY2UoXCIpXCIsIFwiXCIpXHJcblx0XHQuc3BsaXQoXCIsXCIpXHJcblx0XHQubWFwKHY9PiB2LnRyaW0oKSlcclxuXHRyZXR1cm4ge1xyXG5cdFx0cjpOdW1iZXIodGV4dEFycmF5WzBdKSxcclxuXHRcdGc6TnVtYmVyKHRleHRBcnJheVsxXSksXHJcblx0XHRiOk51bWJlcih0ZXh0QXJyYXlbMl0pLFxyXG5cdFx0YTpOdW1iZXIodGV4dEFycmF5WzNdKVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJnYlRvU3RyaW5nKGNvbG9yOlJHQik6c3RyaW5ne1xyXG5cdHJldHVybiBgcmdiKCR7Y29sb3Iucn0sICR7Y29sb3IuZ30sICR7Y29sb3IuYn0pYFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmdiYVRvU3RyaW5nKGNvbG9yOlJHQkEpOnN0cmluZ3tcclxuXHRyZXR1cm4gYHJnYmEoJHtjb2xvci5yfSwgJHtjb2xvci5nfSwgJHtjb2xvci5ifSwgJHtjb2xvci5hfSlgXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZ2JhVG9IZXgoY29sb3I6UkdCQSk6c3RyaW5ne1xyXG5cdGNvbnN0IHsgciwgZywgYiB9ID0gY29sb3I7XHJcblx0cmV0dXJuICcjJyArIFtyLCBnLCBiXS5tYXAoeCA9PiB7XHJcblx0XHRjb25zdCBoZXggPSB4LnRvU3RyaW5nKDE2KTtcclxuXHRcdHJldHVybiBoZXgubGVuZ3RoID09PSAxID8gJzAnICsgaGV4IDogaGV4O1xyXG5cdH0pLmpvaW4oJycpO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnRyYXN0Q29sb3IocmdiOlJHQik6UkdCIHtcclxuXHQvLyBDYWxjdWxhdGUgdGhlIGJyaWdodG5lc3Mgb2YgdGhlIGZvcmVncm91bmQgY29sb3IgKHNpbXBsZSBhcHByb3hpbWF0aW9uKVxyXG5cdGxldCBicmlnaHRuZXNzID0gKHJnYi5yICogMjk5ICsgcmdiLmcgKiA1ODcgKyByZ2IuYiAqIDExNCkgLyAxMDAwO1xyXG5cdC8vIElmIHRoZSBmb3JlZ3JvdW5kIGlzIGJyaWdodCwgdXNlIGJsYWNrOyBvdGhlcndpc2UgdXNlIHdoaXRlXHJcblx0cmV0dXJuIGJyaWdodG5lc3MgPiAxMjggPyB7IHI6IDAsIGc6IDAsIGI6IDAgfSA6IHsgcjogMjU1LCBnOiAyNTUsIGI6IDI1NSB9O1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250cmFzdEJvb2wocmdiOlJHQik6Ym9vbGVhbiB7XHJcblx0cmV0dXJuIGdldENvbnRyYXN0Q29sb3IocmdiKS5yID09PSAwXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBjbGFtcCh2YWx1ZTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcclxuXHRyZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIG1pbiksIG1heCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGp1c3RCcmlnaHRuZXNzKHJnYjogUkdCLCBmYWN0b3I6IG51bWJlcik6IFJHQiB7XHJcblx0Y29uc3QgciA9IHJnYi5yIC8gMjU1LCBnID0gcmdiLmcgLyAyNTUsIGIgPSByZ2IuYiAvIDI1NTtcclxuXHJcblx0Y29uc3QgbWF4ID0gTWF0aC5tYXgociwgZywgYiksIG1pbiA9IE1hdGgubWluKHIsIGcsIGIpO1xyXG5cdGxldCBoID0gMCwgcyA9IDAsIGwgPSAobWF4ICsgbWluKSAvIDI7XHJcblxyXG5cdGlmKG1heCAhPT0gbWluKXtcclxuXHRcdGNvbnN0IGQgPSBtYXggLSBtaW47XHJcblx0XHRzID0gbCA+IDAuNSA/IGQgLyAoMiAtIG1heCAtIG1pbikgOiBkIC8gKG1heCArIG1pbik7XHJcblx0XHRzd2l0Y2gobWF4KXtcclxuXHRcdFx0Y2FzZSByOiBoID0gKGcgLSBiKSAvIGQgKyAoZyA8IGIgPyA2IDogMCk7IGJyZWFrO1xyXG5cdFx0XHRjYXNlIGc6IGggPSAoYiAtIHIpIC8gZCArIDI7IGJyZWFrO1xyXG5cdFx0XHRjYXNlIGI6IGggPSAociAtIGcpIC8gZCArIDQ7IGJyZWFrO1xyXG5cdFx0fVxyXG5cdFx0aCAvPSA2O1xyXG5cdH1cclxuXHJcblx0bCA9IGNsYW1wKGwgKiBmYWN0b3IsIDAsIDEpO1xyXG5cclxuXHRsZXQgcjE6IG51bWJlciwgZzE6IG51bWJlciwgYjE6IG51bWJlcjtcclxuXHRpZihzID09PSAwKXtcclxuXHRcdHIxID0gZzEgPSBiMSA9IGw7XHJcblx0fWVsc2V7XHJcblx0XHRjb25zdCBxID0gbCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcztcclxuXHRcdGNvbnN0IHAgPSAyICogbCAtIHE7XHJcblx0XHRyMSA9IGh1ZTJyZ2IocCwgcSwgaCArIDEvMyk7XHJcblx0XHRnMSA9IGh1ZTJyZ2IocCwgcSwgaCk7XHJcblx0XHRiMSA9IGh1ZTJyZ2IocCwgcSwgaCAtIDEvMyk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4geyByOiBjbGFtcChNYXRoLnJvdW5kKHIxICogMjU1KSwgMCwgMjU1KSwgZzogY2xhbXAoTWF0aC5yb3VuZChnMSAqIDI1NSksIDAsIDI1NSksIGI6IGNsYW1wKE1hdGgucm91bmQoYjEgKiAyNTUpLCAwLCAyNTUpIH07XHJcblxyXG5cdGZ1bmN0aW9uIGh1ZTJyZ2IocDogbnVtYmVyLCBxOiBudW1iZXIsIHQ6IG51bWJlcik6IG51bWJlciB7XHJcblx0XHRpZih0IDwgMCkgdCArPSAxO1xyXG5cdFx0aWYodCA+IDEpIHQgLT0gMTtcclxuXHRcdGlmKHQgPCAxLzYpIHJldHVybiBjbGFtcChwICsgKHEgLSBwKSAqIDYgKiB0LCAwLCAxKTtcclxuXHRcdGlmKHQgPCAxLzIpIHJldHVybiBjbGFtcChxLCAwLCAxKTtcclxuXHRcdGlmKHQgPCAyLzMpIHJldHVybiBjbGFtcChwICsgKHEgLSBwKSAqICgyLzMgLSB0KSAqIDYsIDAsIDEpO1xyXG5cdFx0cmV0dXJuIGNsYW1wKHAsIDAsIDEpO1xyXG5cdH1cclxufVxyXG4iXX0=